<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>A-Frame Camera and GLTF Model</title>
    <meta name="description" content="A-Frame Camera and GLTF Model" />
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
      // JavaScript to handle video texture
      AFRAME.registerComponent("video-texture", {
        schema: {
          src: { type: "string" },
        },
        init: function () {
          const video = document.createElement("video");
          video.srcObject = null; // Initialize to null
          video.autoplay = true;
          video.loop = true;
          this.video = video;

          const texture = new THREE.VideoTexture(video);
          this.el.setAttribute("material", { src: texture, transparent: true }); // Important: transparent for webcam

          navigator.mediaDevices
            .getUserMedia({ video: true })
            .then((stream) => {
              video.srcObject = stream;
            })
            .catch((error) => {
              console.error("Error accessing webcam:", error);
            });
        },
        remove: function () {
          if (this.video.srcObject) {
            const tracks = this.video.srcObject.getTracks();
            tracks.forEach((track) => track.stop());
          }
        },
      });
    </script>
  </head>
  <body style="margin: 0px; overflow: hidden">
    <a-scene>
      <a-entity camera look-controls wasd-controls video-texture></a-entity>
      <a-entity light="type: ambient; color: #FFFFFF; intensity: 0.5"></a-entity>
      <a-entity light="type: directional; color: #FFFFFF; intensity: 0.8; position: 1 1 1"></a-entity>
  
      <a-entity gltf-model="#animated-model" material="side: double" scale="0.1 0.1 0.1" position="0 0 -2"> </a-entity>  </a-scene>
  
      <a-assets>
        <a-asset-item id="animated-model" src="./models/scene.gltf"></a-asset-item>
      </a-assets>
    </a-scene>
  </body>
</html>
